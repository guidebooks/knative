"use strict";(self.webpackChunkKuiClientTemplate=self.webpackChunkKuiClientTemplate||[]).push([[31833,71314],{17425:(e,t,s)=>{s.d(t,{Z:()=>c});var r=s(67294),a=s(91119),n=s(55080),o=s(94516);class i extends r.PureComponent{quitButton(){return r.createElement("div",{className:"sidecar-bottom-stripe-button sidecar-bottom-stripe-quit"},r.createElement("a",{href:"#",className:"graphical-icon kui--tab-navigatable kui--notab-when-sidecar-hidden",tabIndex:-1,"aria-label":"Close",onClick:()=>this.props.onClose()},r.createElement(n.default,{icon:"WindowClose"})))}back(){if(this.props.back)return this.props.back.enabled?r.createElement("span",{className:"sidecar-bottom-stripe-button"},r.createElement("a",{href:"#",className:"graphical-icon kui--tab-navigable"},r.createElement(n.default,{icon:"Back",onClick:this.props.back.onClick,onMouseDown:e=>e.preventDefault(),className:"kui--sidecar--titlebar-navigation--back"}))):r.createElement("span",{className:"sidecar-bottom-stripe-button disabled"},r.createElement("a",{className:"disabled graphical-icon"},r.createElement(n.default,{icon:"Back",onClick:this.props.back.onClick,className:"kui--sidecar--titlebar-navigation--back"})))}forward(){if(this.props.forward)return this.props.forward.enabled?r.createElement("span",{className:"sidecar-bottom-stripe-button"},r.createElement("a",{href:"#",className:"graphical-icon kui--tab-navigable"},r.createElement(n.default,{icon:"Forward",onClick:this.props.forward.onClick,onMouseDown:e=>e.preventDefault(),className:"kui--sidecar--titlebar-navigation--forward"}))):r.createElement("span",{className:"sidecar-bottom-stripe-button disabled"},r.createElement("a",{className:"disabled graphical-icon"},r.createElement(n.default,{icon:"Forward",onClick:this.props.forward.onClick,className:"kui--sidecar--titlebar-navigation--forward"})))}history(){const e=this.props.breadcrumbs&&this.props.breadcrumbs.filter((e=>e.label));return r.createElement("div",{className:"kui--sidecar--titlebar-navigation"},this.back(),this.forward(),e&&e.length>0&&r.createElement(o.Z,{breadcrumbs:e,repl:this.props.repl}))}render(){return r.createElement("div",{className:"sidecar-bottom-stripe zoomable"+(this.props.breadcrumbs?" kui--sidecar--titlebar-has-breadcrumbs":"")},this.history(),r.createElement("div",{className:"sidecar-bottom-stripe-left-bits"}),r.createElement("div",{className:"sidecar-bottom-stripe-right-bits"},r.createElement("div",{className:"sidecar-window-buttons"},!this.props.notCloseable&&this.quitButton())))}}class c extends r.PureComponent{constructor(){super(...arguments),this.dom=r.createRef(),this._preventDefault=e=>e.preventDefault(),this._stopPropagation=e=>e.stopPropagation()}get current(){return this.state}defaultWidth(){return this.props.defaultWidth||"60%"}onEscape(e){"Escape"===e.key&&this.props.active&&!document.getElementById("confirm-dialog")&&!(0,a.isPopup)()&&this.current&&this.props.willChangeSize&&this.props.willChangeSize("0%"===this.props.width?this.defaultWidth():"0%")}onMaximize(){this.props.willChangeSize&&this.props.willChangeSize("100%"),this.setState({isMaximized:!0})}onRestore(){this.props.willChangeSize&&this.props.willChangeSize(this.defaultWidth()),this.setState({isMaximized:!1})}onClose(){this.props.onClose&&this.props.onClose(),this.props.willChangeSize&&this.props.willChangeSize("0%")}isFixedWidth(){return!1}width(){return"visible"+(this.state.isMaximized?" maximized":"")}title(e){return r.createElement(i,Object.assign({},e,{notCloseable:!0,repl:this.props.tab.REPL,width:this.defaultWidth(),onClose:this.onClose.bind(this)}))}}},31833:(e,t,s)=>{s.r(t),s.d(t,{default:()=>B,getStateFromMMR:()=>U});var r=s(11227),a=s.n(r),n=s(67294),o=s(14638),i=s(28883),c=s(29873),l=s(91119),d=s(71314),p=s(77533);function h(e){if("string"==typeof e)return n.createElement(n.Fragment,null,e);if(e instanceof Element)return n.createElement(p.Z,{className:"badge-as-image",content:e});{const t=(e.css||"")+(e.onclick?" clickable":"");if(e.image)return n.createElement("div",null);if(e.fontawesome)return n.createElement("div",null);{const s="green-background"===t?"ok":"red-background"===t?"error":"warning";return n.createElement("div",{className:t||"gray-background",onClick:()=>e.onclick()},n.createElement(d.default,{type:s},e.title))}}}class m extends n.PureComponent{constructor(e){super(e),this.state={cache:h("function"==typeof e.spec?e.spec(e.response,e.tab):e.spec)}}render(){return this.state.cache}}var u=s(25824),b=s(42154),f=s(55080),v=s(59582),E=function(e,t,s,r){return new(s||(s=Promise))((function(a,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function i(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,i)}c((r=r.apply(e,t||[])).next())}))};class g extends n.PureComponent{constructor(){super(...arguments),this._buttonOnclick=this.buttonOnclick.bind(this)}getCommand(){const{tab:e,response:t,button:s,args:r}=this.props;if((0,l.isViewButton)(s))return s.command;{const a="string"==typeof s.command?s.command:s.command(e,t,r);return s.confirm?`confirm "${a}"`:a}}buttonOnclick(){return E(this,void 0,void 0,(function*(){const e=yield this.getCommand(),{tab:t,execUUID:s,response:r,button:a,args:n}=this.props;if("string"==typeof e)return(0,l.isViewButton)(a)||a.confirm?t.REPL.qexec(e,void 0,void 0,{rethrowErrors:!0}):a.inPlace?t.REPL.reexec(e,{execUUID:s}):t.REPL.pexec(e);"function"==typeof e&&e(t,r,n)}))}render(){const{button:e}=this.props;return n.createElement(v.default,{content:e.label||e.mode},n.createElement("span",{className:"kui--tab-navigatable kui--notab-when-sidecar-hidden sidecar-bottom-stripe-button-as-button sidecar-bottom-stripe-button"+(e.icon?" kui--toolbar-button-with-icon":"")},n.createElement("div",{role:"presentation",onClick:this._buttonOnclick,"data-mode":e.mode},n.createElement("span",{role:"tab"},e.icon?e.icon:e.label||e.mode))))}}var x=s(11278);class k extends n.PureComponent{icon(){if(this.props.toolbarText){const{type:e}=this.props.toolbarText;switch(e){case"info":return n.createElement(f.default,{icon:"Info"});case"success":return n.createElement(f.default,{icon:"Checkmark"});case"warning":return n.createElement(f.default,{icon:"Warning"});case"error":return n.createElement(f.default,{icon:"Error"})}return function(e){throw new Error("Did not expect to get here")}()}}buttons(){if(this.props.buttons)return this.props.buttons.sort().sort(((e,t)=>(e.order||0)-(t.order||0))).map(((e,t)=>n.createElement(g,{tab:this.props.tab,execUUID:this.props.execUUID,button:e,response:this.props.response,args:this.props.args,key:t})))}render(){try{return n.createElement("div",{className:"sidecar-bottom-stripe-toolbar"},n.createElement("div",{className:"sidecar-toolbar-text","data-location-bottom":this.props.bottom||void 0,"data-type":this.props.toolbarText&&this.props.toolbarText.type},n.createElement("div",{className:"sidecar-toolbar-text-icon"},this.icon()),this.props.toolbarText&&("string"==typeof this.props.toolbarText.text?n.createElement(x.default,{source:this.props.toolbarText.text,className:"sidecar-toolbar-text-content"}):n.createElement("div",{className:"sidecar-toolbar-text-content",dangerouslySetInnerHTML:{__html:this.props.toolbarText.text.innerHTML}}))),n.createElement("div",{className:"sidecar-bottom-stripe-mode-bits sidecar-bottom-stripe-button-container","data-location-bottom":this.props.bottom||void 0},n.createElement("div",{className:"fill-container flex-layout flush-right flex-align-stretch"},this.buttons())))}catch(e){return console.error(e),n.createElement("div",null)}}}class C extends n.PureComponent{constructor(e){super(e),this._willUpdateToolbar=this.onToolbarUpdate.bind(this),this.state={}}onToolbarUpdate(e,t,s){this.setState({extraButtons:t,extraButtonsOverride:s}),!e||this.props.toolbarText&&e.type===this.props.toolbarText.type&&e.text===this.props.toolbarText.text&&e.alerts===this.props.toolbarText.alerts||this.props.didUpdateToolbar(e)}children(){return n.isValidElement(this.props.children)?n.cloneElement(this.props.children,{willUpdateToolbar:this._willUpdateToolbar}):this.props.children}render(){const e=this.state.extraButtonsOverride&&Array.isArray(this.state.extraButtons)?this.state.extraButtons:this.props.buttons.concat(this.state.extraButtons||[]),t=this.props.toolbarText||0!==e.length,s=!this.props.noAlerts&&this.props.toolbarText&&this.props.toolbarText.alerts&&0!==this.props.toolbarText.alerts.length;return n.createElement("div",{className:"full-height"},t&&n.createElement(k,{tab:this.props.tab,execUUID:this.props.execUUID,response:this.props.response,args:this.props.args,toolbarText:this.props.toolbarText,buttons:e}),s&&n.createElement(n.Suspense,{fallback:n.createElement("div",null)},this.props.toolbarText.alerts.map(((e,t)=>n.createElement(b.default,{key:t,alert:e})))),n.createElement(n.Suspense,{fallback:n.createElement("div",null)},this.children()))}}var N=s(17425),y=s(23653);const w=n.lazy((()=>s.e(71126).then(s.bind(s,71126)))),T=a()("plugin-sidecar/components/TopNavSidecar");function U(e,t){let s=t.modes.slice(0);(0,l.isResourceWithMetadata)(t)?(0,l.addRelevantModes)(e,s,"",{resource:t}):(0,l.isResourceByReference)(t)&&(0,l.addRelevantModes)(e,s,"",t),s=s.sort(((e,t)=>(e.order||0)-(t.order||0)));const r=s.filter((e=>!(0,l.isButton)(e))),a=t.defaultMode?r.findIndex((e=>e.mode===t.defaultMode)):-1,n=-1===a?r.findIndex((e=>e.defaultMode)):a,o=-1===n?0:n,i=s.filter(l.isButton),c=(t.buttons||[]).concat(i);return{currentTabIndex:o,defaultMode:o,tabs:r,toolbarText:r[o]&&r[o].toolbarText||t.toolbarText,viewButtons:c.filter((e=>!("drilldown"===e.kind&&e.showRelatedResource))),drilldownButtons:c.filter((e=>"drilldown"===e.kind&&e.showRelatedResource))}}class B extends N.Z{constructor(e){super(e),this._didUpdateToolbar=this.didUpdateToolbar.bind(this),this._onSelect=this.onSelect.bind(this),this.state=B.getDerivedStateFromProps(e)}static getDerivedStateFromProps(e,t){const{tab:s,response:r}=e;if(t&&t.response===r)return t;{const a={argsForMode:r.argsForMode,argvNoOptions:e.argvNoOptions,parsedOptions:e.parsedOptions};return Object.assign(t||{},{response:r,toolbarText:r.toolbarText,args:a},U(s,r))}}headerBodyStyle(){return{"flex-direction":"column"}}prettyName(){return this.state.response&&(this.state.response.prettyName||(this.state.response.metadata?this.state.response.metadata.name:void 0))}namePart(){return"heroText"===this.context.sidecarName&&this.state.response&&this.state.response.metadata&&this.state.response.metadata.name&&n.createElement("div",{className:"header-left-bits"},n.createElement("div",{className:"sidecar-header-text"},n.createElement("div",{className:"sidecar-header-name","data-base-class":"sidecar-header-name"},n.createElement("div",{className:"sidecar-header-name-content","data-base-class":"sidecar-header-name-content"},this.state.response.metadata.name))))}didUpdateToolbar(e){this.setState({toolbarText:e})}fillerNamePart(){return n.createElement("div",{className:"header-left-bits"})}broadcastFocusChange(e){const t=this.current.tabs[this.current.currentTabIndex];l.Events.eventChannelUnsafe.emit(`/mode/focus/off/tab/${this.props.uuid}/mode/${t.mode}`,t);const s=this.current.tabs[e];l.Events.eventChannelUnsafe.emit(`/mode/focus/on/tab/${this.props.uuid}/mode/${s.mode}`,s)}eventKey(e){return e}idxFromEventKey(e){return e}onSelect(e,t){const s=this.idxFromEventKey(t);this.broadcastFocusChange(s),this.setState((e=>{const t=e.tabs[s].toolbarText||e.toolbarText;return Object.assign({},e,{currentTabIndex:s,toolbarText:t})}))}tabs(){return n.createElement("div",{className:"kui--sidecar-tabs-container zoomable full-height",onClick:this._stopPropagation},n.createElement(o.m,{className:"sidecar-bottom-stripe-mode-bits sidecar-bottom-stripe-button-container kui--sidecar-tabs",activeKey:this.eventKey(this.current.currentTabIndex),onSelect:this._onSelect},this.current.tabs.map(((e,t)=>n.createElement(i.O,{key:e.mode,id:e.mode,eventKey:this.eventKey(t),className:"sidecar-bottom-stripe-button kui--sidecar-tab",title:n.createElement(c.T,{className:"kui--sidecar-tab-label"},e.label||e.mode),"data-mode":e.mode,"data-is-selected":t===this.current.currentTabIndex||void 0,onMouseDown:this._preventDefault},this.tabContent(t))))))}bodyContent(e){const t=this.current.tabs[e];return n.createElement(w,{tab:this.props.tab,mode:t,isActive:e===this.current.currentTabIndex,args:this.state.args,response:this.state.response,execUUID:this.props.execUUID})}tabContent(e){return n.createElement(y.ME.Consumer,null,(t=>n.createElement("div",{className:"sidecar-content-container kui--tab-content",hidden:e!==this.current.currentTabIndex||void 0},n.createElement("div",{className:"custom-content"},n.createElement(C,{tab:this.props.tab,execUUID:this.props.execUUID,response:this.state.response,args:this.state.args,didUpdateToolbar:this._didUpdateToolbar,toolbarText:this.state.toolbarText,noAlerts:this.current.currentTabIndex!==this.current.defaultMode,buttons:t.executable?this.current.viewButtons:[]},this.bodyContent(e))))))}badges(){const e=l.badgeRegistrar.filter((({when:e})=>{try{return e(this.state.response)}catch(e){return T("warning: registered badge threw an exception during filter",e),!1}}));return e&&e.length>0&&n.createElement("div",{className:"badges"},e.map((({badge:e},t)=>n.createElement(m,{key:t,spec:e,tab:this.props.tab,response:this.state.response}))))}header(){const e=this.namePart(),t=this.badges();if(e||t)return n.createElement("header",{className:"sidecar-header"},n.createElement("div",{className:"header-main-content"},n.createElement("div",{className:"kui--sidecar-header-and-toolbar"},n.createElement("div",{className:"header-top-bits"},e||this.fillerNamePart(),n.createElement("div",{className:"header-right-bits"},n.createElement("div",{className:"custom-header-content"},t))))))}footer(){return n.createElement(y.ME.Consumer,null,(e=>e.executable&&n.createElement(k,{bottom:!0,tab:this.props.tab,execUUID:this.props.execUUID,response:this.state.response,args:this.state.args,buttons:this.current.drilldownButtons})))}kindBreadcrumb(){const{kind:e,onclick:t}=this.state.response;return{label:e,command:t&&t.kind,className:"kui--sidecar-kind"}}nameBreadcrumb(){const{onclick:e}=this.state.response;return{label:this.prettyName(),command:e&&e.name,isCurrentPage:!0,className:"kui--sidecar-entity-name"}}versionBreadcrumb(){return this.state.response.version?{label:this.state.response.version,className:"kui--version-breadcrumb"}:void 0}nameHashBreadcrumb(){const{onclick:e}=this.state.response;return{label:this.state.response&&this.state.response.nameHash,command:e&&e.nameHash,deemphasize:!0,className:"kui--sidecar-entity-name-hash"}}namespaceBreadcrumb(){const{metadata:{namespace:e},onclick:t}=this.state.response;return{label:e,command:t&&t.namespace,deemphasize:!0,className:"kui--sidecar-entity-namespace"}}render(){if(!this.current||!this.state.response)return this.props.onRender&&this.props.onRender(!1),n.createElement("div",null);this.props.onRender&&setTimeout((()=>this.props.onRender(!0)));const e="breadcrumb"===this.context.sidecarName?[this.nameBreadcrumb(),this.versionBreadcrumb(),this.nameHashBreadcrumb()]:[];try{const t=[this.kindBreadcrumb()].concat(e).concat(this.namespaceBreadcrumb()).filter((e=>e));return n.createElement("div",{className:"kui--sidecar kui--sidecar-nested "+this.width(),ref:this.dom,"data-view":"topnav",onClick:this._stopPropagation},this.title({breadcrumbs:t}),n.createElement("div",{className:"kui--sidecar-header-and-body",style:{flexDirection:"column"}},this.header(),this.tabs(),this.footer()))}catch(e){console.error(e)}}}B.contextType=u.Z},42154:(e,t,s)=>{s.r(t),s.d(t,{default:()=>i});var r=s(67294);const a=r.lazy((()=>Promise.all([s.e(33676),s.e(37316),s.e(72683),s.e(23749),s.e(81346),s.e(88038),s.e(13973),s.e(54680),s.e(21947),s.e(80236),s.e(20237),s.e(67809),s.e(23546),s.e(80431),s.e(72259)]).then(s.bind(s,80431)).then((e=>({default:e.Alert}))))),n=r.lazy((()=>Promise.all([s.e(33676),s.e(37316),s.e(72683),s.e(23749),s.e(81346),s.e(88038),s.e(13973),s.e(54680),s.e(21947),s.e(80236),s.e(20237),s.e(67809),s.e(23546),s.e(80431),s.e(72259)]).then(s.bind(s,80431)).then((e=>({default:e.AlertActionCloseButton})))));class o extends r.PureComponent{constructor(e){super(e),this._onClose=this.onClose.bind(this),this.state=o.getDerivedStateFromProps(e)}static getDerivedStateFromProps(e,t){return t&&e===t.props?t:{props:e,isClosed:!1}}onClose(){this.props.onCloseButtonClick&&this.props.onCloseButtonClick(),this.setState({isClosed:!0})}render(){return this.state.isClosed?r.createElement(r.Fragment,null):r.createElement(a,{id:this.props.id||"",className:"kui--toolbar-alert "+(this.props.className||""),"data-type":this.props.alert.type,title:this.props.alert.title,actionClose:!this.props.hideCloseButton&&r.createElement(n,{onClose:this._onClose}),timeout:this.props.timeout,onTimeout:this._onClose,isInline:!this.props.isGlobal,variant:"error"===this.props.alert.type?"danger":this.props.alert.type},r.createElement(r.Fragment,null,this.props.alert.body||"",this.props.children))}}function i(e){return r.createElement(r.Suspense,{fallback:r.createElement("div",null)},r.createElement(o,Object.assign({},e)))}},71314:(e,t,s)=>{s.r(t),s.d(t,{default:()=>n});var r=s(67294);const a=r.lazy((()=>s.e(71068).then(s.bind(s,71068))));function n(e){return r.createElement(a,Object.assign({},e))}}}]);